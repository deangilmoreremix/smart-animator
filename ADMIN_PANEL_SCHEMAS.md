# Admin Panel Type Schemas

All admin panel types are centralized in `/types.ts` for consistency and reusability across the application.

---

## User Management Types

### `UserRole`
```typescript
export type UserRole = 'user' | 'admin' | 'superadmin';
```
Defines the three permission levels in the system.

### `UserStatus`
```typescript
export type UserStatus = 'active' | 'suspended' | 'banned' | 'trial';
```
Defines the possible states of a user account.

### `UserWithRole`
```typescript
export interface UserWithRole {
  user_id: string;
  email: string;
  role: UserRole;
  status?: UserStatus;
  suspension_reason?: string;
  suspension_until?: string;
  last_login_at?: string;
  last_login_ip?: string;
  notes?: string;
}
```
Complete user object with role and status information. Used in user management tables.

**Fields:**
- `user_id` - Unique user identifier (UUID)
- `email` - User's email address
- `role` - User's permission level
- `status` - Account status (optional)
- `suspension_reason` - Why user was suspended (optional)
- `suspension_until` - When suspension expires (optional, ISO timestamp)
- `last_login_at` - Last login timestamp (optional)
- `last_login_ip` - Last login IP address (optional)
- `notes` - Admin notes about the user (optional)

---

## Analytics Types

### `UserAnalytics`
```typescript
export interface UserAnalytics {
  user_id: string;
  email: string;
  role: string;
  video_count: number;
  contact_count: number;
  campaign_count: number;
  last_login?: string;
  created_at: string;
  total_storage_mb: number;
}
```
Analytics data for individual users.

**Fields:**
- `user_id` - Unique user identifier
- `email` - User's email address
- `role` - User's role
- `video_count` - Total videos generated by user
- `contact_count` - Total contacts in user's database
- `campaign_count` - Total campaigns created by user
- `last_login` - Last login timestamp (optional)
- `created_at` - Account creation timestamp
- `total_storage_mb` - Storage used in megabytes

**Usage:** Analytics tab in Admin Panel

### `PlatformStats`
```typescript
export interface PlatformStats {
  total_users: number;
  total_videos: number;
  total_contacts: number;
  total_campaigns: number;
  active_users_7d: number;
  active_users_30d: number;
  new_users_7d: number;
  new_users_30d: number;
}
```
Platform-wide statistics for dashboard overview.

**Fields:**
- `total_users` - Total registered users
- `total_videos` - Total videos generated
- `total_contacts` - Total contacts across all users
- `total_campaigns` - Total campaigns created
- `active_users_7d` - Users active in last 7 days
- `active_users_30d` - Users active in last 30 days
- `new_users_7d` - New registrations in last 7 days
- `new_users_30d` - New registrations in last 30 days

**Usage:** Dashboard stat cards at top of Admin Panel

### `VideoStats`
```typescript
export interface VideoStats {
  id: string;
  user_id: string;
  user_email: string;
  title: string;
  status: string;
  created_at: string;
  duration: number;
  video_url: string | null;
}
```
Video information for content moderation.

**Fields:**
- `id` - Video unique identifier (UUID)
- `user_id` - Owner's user ID
- `user_email` - Owner's email address
- `title` - Video title
- `status` - Generation status (pending, processing, completed, failed)
- `created_at` - Creation timestamp
- `duration` - Video duration in seconds
- `video_url` - URL to view video (null if not completed)

**Usage:** Videos tab for content moderation

---

## Audit Types

### `AuditAction`
```typescript
export type AuditAction = 'role_update' | 'user_delete';
```
Types of actions that are logged in the audit system.

### `AuditLog`
```typescript
export interface AuditLog {
  id: string;
  user_id: string;
  user_email: string;
  changed_by: string;
  changed_by_email: string;
  action: AuditAction;
  old_value: string | null;
  new_value: string | null;
  created_at: string;
}
```
Audit log entry for tracking admin actions.

**Fields:**
- `id` - Log entry unique identifier
- `user_id` - User who was affected by the action
- `user_email` - Email of affected user
- `changed_by` - Admin who performed the action (user ID)
- `changed_by_email` - Email of admin who made change
- `action` - Type of action performed
- `old_value` - Previous value (for role updates)
- `new_value` - New value (for role updates)
- `created_at` - When action was performed

**Usage:** Audit Logs tab for compliance tracking

---

## Announcement Types

### `Announcement`
```typescript
export interface Announcement {
  id: string;
  created_by: string;
  title: string;
  message: string;
  type: 'info' | 'warning' | 'success' | 'error';
  target_roles: UserRole[];
  is_active: boolean;
  starts_at?: string;
  ends_at?: string;
  created_at: string;
}
```
System announcement for communicating with users.

**Fields:**
- `id` - Announcement unique identifier
- `created_by` - Admin who created announcement (user ID)
- `title` - Announcement title
- `message` - Announcement content
- `type` - Visual style (info, warning, success, error)
- `target_roles` - Which roles can see it (array of UserRole)
- `is_active` - Whether announcement is currently shown
- `starts_at` - When to start showing (optional)
- `ends_at` - When to stop showing (optional)
- `created_at` - Creation timestamp

**Usage:** Future feature for system-wide communications

---

## Database Schema Mapping

### Tables

#### `user_roles`
Maps to: `UserWithRole`
```sql
- id (uuid, PK)
- user_id (uuid, unique)
- role (text: 'user' | 'admin' | 'superadmin')
- status (text: 'active' | 'suspended' | 'banned' | 'trial')
- suspension_reason (text, nullable)
- suspension_until (timestamptz, nullable)
- last_login_at (timestamptz, nullable)
- last_login_ip (text, nullable)
- notes (text, nullable)
- created_at (timestamptz)
- updated_at (timestamptz)
```

#### `audit_logs`
Maps to: `AuditLog`
```sql
- id (uuid, PK)
- user_id (uuid)
- changed_by (uuid)
- action (text: 'role_update' | 'user_delete')
- old_value (text, nullable)
- new_value (text, nullable)
- created_at (timestamptz)
```

#### `announcements`
Maps to: `Announcement`
```sql
- id (uuid, PK)
- created_by (uuid)
- title (text)
- message (text)
- type (text: 'info' | 'warning' | 'success' | 'error')
- target_roles (text[])
- is_active (boolean)
- starts_at (timestamptz, nullable)
- ends_at (timestamptz, nullable)
- created_at (timestamptz)
```

#### `video_generations`
Maps to: `VideoStats` (partial)
```sql
- id (uuid, PK)
- user_id (uuid)
- title (text)
- status (text)
- duration (integer)
- video_url (text, nullable)
- created_at (timestamptz)
- ... (other fields)
```

---

## Import Usage

All types are exported from the central `/types.ts` file:

```typescript
// Import types in any component or service
import type {
  UserRole,
  UserStatus,
  UserWithRole,
  UserAnalytics,
  PlatformStats,
  VideoStats,
  AuditLog,
  AuditAction,
  Announcement
} from '../types';
```

---

## Type Safety

All types are fully typed with TypeScript for:
- ✅ Compile-time type checking
- ✅ IntelliSense autocomplete
- ✅ Documentation through JSDoc comments
- ✅ Refactoring safety
- ✅ API contract enforcement

---

## Future Extensions

To add new admin features:

1. Add types to `/types.ts`
2. Create corresponding database migration
3. Add service functions using the types
4. Import types in components as needed

Example:
```typescript
// 1. Add to types.ts
export interface SystemMetrics {
  cpu_usage: number;
  memory_usage: number;
  disk_usage: number;
}

// 2. Create migration
// supabase/migrations/xxxx_create_system_metrics.sql

// 3. Add service
// services/metricsService.ts
import type { SystemMetrics } from '../types';
export const metricsService = {
  async getMetrics(): Promise<SystemMetrics> { ... }
};

// 4. Use in component
import type { SystemMetrics } from '../types';
const [metrics, setMetrics] = useState<SystemMetrics | null>(null);
```
